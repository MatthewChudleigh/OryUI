@page "/identities/users"
@attribute [StreamRendering]
@attribute [RenderModeInteractiveServer]
@inject ICustomTranslator Translator
@inject ILogger<Home> Logger
@inject NavigationManager Navigation

<PageTitle>Identities</PageTitle>

<div class="buttons mb-5">
    <a href="identities/users/create" class="button is-success">
        New Identity
    </a>
    <button class="button is-info" @onclick="@RefreshPage">
        Refresh Page
    </button>
</div>

@if (_isLoading)
{
    // is loading
    <p>Loading data...</p>
}
else
{
    if (_identities!.Count == 0)
    {
        <p>There are no created users yet.</p>
    }
    else
    {
        <table class="table is-fullwidth is-striped">
            <thead>
            <tr>
                <td>ID</td>
                <td>Name</td>
            </tr>
            </thead>
            <tbody>
            @foreach (var identity in _identities!)
            {
                <tr>
                    <td>
                        <a class="btn-link" href="identities/users/@(identity.Id)">
                            @identity.Id
                        </a>
                    </td>
                    <td>
                        <a class="btn-link" href="identities/users/@(identity.Id)">
                            @foreach (var address in identity.VerifiableAddresses)
                            {
                                <p>@(address.Value)</p>
                            }
                        </a>
                    </td>
                </tr>
            }
            </tbody>
        </table>

        <nav class="pagination is-centered" role="navigation" aria-label="pagination">
            <a href="identities/users?page=@(PageNr - 1)"
               class="pagination-previous @(PageNr < 2 ? "is-disabled" : "")">
                Previous
            </a>
            <a href="identities/users?page=@(PageNr + 1)"
               class="pagination-next @(PageNr > 12345 ? "is-disabled" : "")">
                Next Page
            </a>
            <ul class="pagination-list">
                <PaginationLink IsActive="@(PageNr == 1)" PageNr="1"/>
                <PaginationEllipsis IsHidden="@(PageNr < 5)"/>
                @for (var i = int.Max(2, (int)PageNr! - 2); i < int.Min(23, (int)PageNr + 3); i++)
                {
                    <PaginationLink IsActive="@(i == PageNr)" PageNr="i"/>
                }
                <PaginationEllipsis IsHidden="@(PageNr > 20)"/>
                <PaginationLink IsActive="@(PageNr == 23)" PageNr="23"/>
            </ul>
        </nav>
    }
}